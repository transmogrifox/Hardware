Version 4
SHEET 1 2604 2368
WIRE 240 -1264 -64 -1264
WIRE 336 -1264 240 -1264
WIRE 448 -1264 336 -1264
WIRE 656 -1264 528 -1264
WIRE 800 -1264 656 -1264
WIRE 1008 -1264 880 -1264
WIRE 1152 -1264 1008 -1264
WIRE 1344 -1264 1232 -1264
WIRE 1360 -1264 1344 -1264
WIRE -64 -1168 -64 -1264
WIRE 336 -1152 336 -1264
WIRE 240 -1136 240 -1264
WIRE 656 -1136 656 -1264
WIRE 1008 -1136 1008 -1264
WIRE 1360 -1136 1360 -1264
WIRE -64 -976 -64 -1088
WIRE 240 -976 240 -1072
WIRE 240 -976 -64 -976
WIRE 336 -976 336 -1072
WIRE 336 -976 240 -976
WIRE 656 -976 656 -1072
WIRE 656 -976 336 -976
WIRE 656 -928 656 -976
WIRE 1008 -928 1008 -1072
WIRE 1360 -928 1360 -1072
WIRE 272 -752 -32 -752
WIRE 368 -752 272 -752
WIRE 480 -752 368 -752
WIRE 688 -752 560 -752
WIRE 832 -752 688 -752
WIRE 1040 -752 912 -752
WIRE 1184 -752 1040 -752
WIRE 1376 -752 1264 -752
WIRE 1392 -752 1376 -752
WIRE -32 -656 -32 -752
WIRE 368 -640 368 -752
WIRE 272 -624 272 -752
WIRE 688 -624 688 -752
WIRE 1040 -624 1040 -752
WIRE 1392 -624 1392 -752
WIRE -32 -464 -32 -576
WIRE 272 -464 272 -560
WIRE 272 -464 -32 -464
WIRE 368 -464 368 -560
WIRE 368 -464 272 -464
WIRE 688 -464 688 -560
WIRE 688 -464 368 -464
WIRE 688 -416 688 -464
WIRE 1040 -416 1040 -560
WIRE 1392 -416 1392 -560
WIRE 32 -64 -96 -64
WIRE 208 -64 32 -64
WIRE 944 -64 208 -64
WIRE 208 80 208 -64
WIRE 944 80 944 -64
WIRE -96 128 -96 -64
WIRE -96 256 -96 208
WIRE 208 288 208 160
WIRE 256 288 208 288
WIRE 400 288 256 288
WIRE 544 288 464 288
WIRE 944 288 944 160
WIRE 944 288 624 288
WIRE 1008 288 944 288
WIRE 208 368 208 288
WIRE -1088 512 -1136 512
WIRE -992 512 -1008 512
WIRE -880 512 -928 512
WIRE 208 576 208 448
WIRE -96 592 -128 592
WIRE -32 592 -96 592
WIRE 96 592 48 592
WIRE 160 592 96 592
WIRE -672 608 -720 608
WIRE -1600 624 -1616 624
WIRE -1392 624 -1600 624
WIRE -1216 624 -1296 624
WIRE -1136 624 -1136 512
WIRE -1136 624 -1216 624
WIRE -1072 624 -1136 624
WIRE -912 624 -992 624
WIRE -880 624 -880 512
WIRE -880 624 -912 624
WIRE -784 624 -880 624
WIRE 160 640 112 640
WIRE -912 656 -912 624
WIRE -96 656 -96 592
WIRE -1616 672 -1616 624
WIRE -1392 672 -1504 672
WIRE -1232 672 -1280 672
WIRE 112 672 112 640
WIRE -1392 704 -1424 704
WIRE -912 736 -912 720
WIRE -784 736 -784 656
WIRE -784 736 -912 736
WIRE 208 736 208 656
WIRE 208 736 176 736
WIRE 384 736 208 736
WIRE 624 736 464 736
WIRE 672 736 624 736
WIRE -1424 752 -1424 704
WIRE -912 768 -912 736
WIRE -96 800 -96 736
WIRE -1616 816 -1616 752
WIRE 208 816 208 736
WIRE 672 832 672 736
WIRE -1504 864 -1504 672
WIRE 208 928 208 896
WIRE -576 960 -928 960
WIRE -1232 976 -1232 672
WIRE -1184 976 -1232 976
WIRE -1136 976 -1184 976
WIRE -1040 976 -1056 976
WIRE -928 976 -928 960
WIRE -928 976 -976 976
WIRE -576 976 -752 976
WIRE -464 976 -512 976
WIRE 672 976 672 896
WIRE -576 992 -624 992
WIRE -1504 1008 -1504 944
WIRE -624 1008 -624 992
WIRE -576 1008 -624 1008
WIRE -624 1024 -624 1008
WIRE -576 1024 -624 1024
WIRE -752 1040 -752 976
WIRE -624 1056 -624 1024
WIRE -560 1056 -560 1024
WIRE -560 1056 -624 1056
WIRE -560 1072 -560 1056
WIRE -1184 1088 -1184 976
WIRE -1120 1088 -1184 1088
WIRE -960 1088 -1040 1088
WIRE -928 1088 -928 976
WIRE -928 1088 -960 1088
WIRE -960 1120 -960 1088
WIRE -16 1120 -64 1120
WIRE 416 1120 -16 1120
WIRE 848 1120 704 1120
WIRE 896 1120 848 1120
WIRE 944 1120 896 1120
WIRE 1008 1120 944 1120
WIRE 1200 1120 1088 1120
WIRE 1856 1120 1680 1120
WIRE 1984 1120 1856 1120
WIRE 2032 1120 1984 1120
WIRE 2080 1120 2032 1120
WIRE 2432 1120 2352 1120
WIRE 2512 1120 2432 1120
WIRE -752 1184 -752 1120
WIRE -64 1200 -64 1120
WIRE 416 1200 416 1120
WIRE 704 1216 704 1120
WIRE 1680 1216 1680 1120
WIRE 1856 1216 1856 1120
WIRE -960 1232 -960 1184
WIRE 944 1232 944 1120
WIRE 2080 1232 2080 1120
WIRE 2352 1232 2352 1120
WIRE 2512 1232 2512 1120
WIRE 848 1248 848 1120
WIRE 1200 1248 1200 1120
WIRE 1984 1248 1984 1120
WIRE -64 1408 -64 1280
WIRE 416 1408 416 1280
WIRE 416 1408 -64 1408
WIRE 704 1408 704 1296
WIRE 704 1408 416 1408
WIRE 848 1408 848 1312
WIRE 848 1408 704 1408
WIRE 944 1408 944 1312
WIRE 944 1408 848 1408
WIRE 1200 1408 1200 1312
WIRE 1200 1408 944 1408
WIRE 1680 1408 1680 1296
WIRE 1680 1408 1200 1408
WIRE 1856 1408 1856 1296
WIRE 1856 1408 1680 1408
WIRE 1984 1408 1984 1312
WIRE 1984 1408 1856 1408
WIRE 2080 1408 2080 1312
WIRE 2080 1408 1984 1408
WIRE 2352 1408 2352 1312
WIRE 2352 1408 2080 1408
WIRE 2512 1408 2512 1312
WIRE 2512 1408 2352 1408
WIRE -2128 1424 -2368 1424
WIRE -1824 1424 -2064 1424
WIRE -1744 1424 -1824 1424
WIRE -1648 1424 -1744 1424
WIRE -64 1456 -64 1408
WIRE -1824 1520 -1824 1424
WIRE -1648 1536 -1648 1424
WIRE -2368 1680 -2368 1424
WIRE -1824 1712 -1824 1600
WIRE -1648 1712 -1648 1600
WIRE -1648 1712 -1824 1712
WIRE -1824 1760 -1824 1712
WIRE -2368 1824 -2368 1760
WIRE 528 1824 480 1824
WIRE 656 1824 528 1824
WIRE 736 1824 656 1824
WIRE 896 1824 816 1824
WIRE 1072 1824 896 1824
WIRE 1136 1824 1072 1824
WIRE 1264 1824 1136 1824
WIRE 1360 1824 1264 1824
WIRE 1520 1824 1424 1824
WIRE -2128 1872 -2256 1872
WIRE -1824 1872 -2064 1872
WIRE -1744 1872 -1824 1872
WIRE -1648 1872 -1744 1872
WIRE 480 1936 480 1824
WIRE 656 1952 656 1824
WIRE 896 1952 896 1824
WIRE -1824 1968 -1824 1872
WIRE 1520 1968 1520 1824
WIRE -1648 1984 -1648 1872
WIRE 1136 1984 1136 1824
WIRE 1264 2000 1264 1824
WIRE -2256 2032 -2256 1872
WIRE -1824 2160 -1824 2048
WIRE -1648 2160 -1648 2048
WIRE -1648 2160 -1824 2160
WIRE 480 2160 480 2016
WIRE 656 2160 656 2016
WIRE 656 2160 480 2160
WIRE 896 2160 896 2016
WIRE 896 2160 656 2160
WIRE 1136 2160 1136 2064
WIRE 1136 2160 896 2160
WIRE 1264 2160 1264 2064
WIRE 1264 2160 1136 2160
WIRE 1520 2160 1520 2048
WIRE 1520 2160 1264 2160
WIRE -2256 2176 -2256 2112
WIRE -1824 2208 -1824 2160
WIRE 480 2240 480 2160
FLAG 208 928 0
FLAG -1616 816 0
FLAG -96 256 0
FLAG 1008 288 Vdg
FLAG 32 -64 Vin
FLAG 256 288 Vd
FLAG 176 736 Vs
FLAG 96 592 Vg
FLAG -1600 624 CLK
FLAG -64 1456 0
FLAG 2032 1120 ViControl
FLAG -16 1120 Vcont
FLAG 480 2240 0
FLAG 1072 1824 SFST
FLAG -128 592 PG
FLAG -1424 752 0
FLAG -1504 1008 0
FLAG -672 608 vg0_d
FLAG -96 800 0
FLAG 2432 1120 Vtrip
FLAG -1824 1760 0
FLAG -1744 1424 mcmp
FLAG -1824 2208 0
FLAG -1744 1872 ramptimer
FLAG -2256 2176 0
FLAG -2368 1824 0
FLAG 896 1120 Vcs_
FLAG 528 1824 sfst_
FLAG 672 976 0
FLAG 624 736 Vsfilt
FLAG 688 -416 0
FLAG 1040 -416 0
FLAG 1376 -752 Pintake
FLAG 1392 -416 0
FLAG 656 -928 0
FLAG 1008 -928 0
FLAG 1344 -1264 Iload
FLAG 1360 -928 0
FLAG -1232 672 sg0_
FLAG -912 768 0
FLAG -560 1072 0
FLAG -464 976 sg0
FLAG -752 1184 0
FLAG -960 1232 0
FLAG -1216 624 vg0
FLAG 1200 1120 Vcs
FLAG 112 672 0
SYMBOL ind 192 64 R0
SYMATTR InstName L1
SYMATTR Value 35µ
SYMATTR SpiceLine Rser=80m
SYMBOL voltage -1616 656 R0
WINDOW 3 -625 114 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 1 {1/65k} 50n 50n {0.01/65k} {1/65k})
SYMATTR InstName V1
SYMBOL voltage -96 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply
SYMATTR Value 12
SYMBOL res 192 800 R0
SYMATTR InstName Rcs
SYMATTR Value {Rsense}
SYMBOL res 64 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 5.6
SYMBOL res 192 352 R0
SYMATTR InstName Rprobe
SYMATTR Value 1µ
SYMBOL res 400 1184 R0
SYMATTR InstName RiCont
SYMATTR Value 1
SYMBOL bi 1680 1296 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -31 -159 Left 2
SYMATTR InstName Bprobe
SYMATTR Value I=I(Rprobe)
SYMBOL res 2064 1216 R0
SYMATTR InstName RiSense2
SYMATTR Value 1
SYMBOL cap 1968 1248 R0
SYMATTR InstName C2
SYMATTR Value 50p
SYMBOL bi 480 1936 M0
SYMATTR InstName BiPD
SYMATTR Value I=if(V(Vcs,Vtrip)>0, 1.8/Rpd, 0)
SYMBOL cap 640 1952 R0
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC=1
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 832 1808 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 2.2k
SYMBOL cap 880 1952 R0
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC=1
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL current 1136 2064 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 26µ
SYMBOL schottky 1280 2064 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1360 1840 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 1520 1952 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL bi -64 1280 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName BiPD1
SYMATTR Value I=if(V(SFST)>1,(V(SFST)-1)*0.07/Rsense,0)
SYMBOL Digital\\srflop -1344 576 R0
SYMATTR InstName A1
SYMBOL bv -1504 848 R0
WINDOW 3 -413 106 Left 2
SYMATTR InstName B1
SYMATTR Value V=if( V(ViControl)>V(Vcont), 1, 0)
SYMBOL bv -96 640 M0
SYMATTR InstName B2
SYMATTR Value V=7.5*V(vg0)
SYMBOL current 2352 1312 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -248 -146 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Itrip
SYMATTR Value PULSE(8 8.1 35m 1u 1u 3m 6m)
SYMBOL res 2496 1216 R0
SYMATTR InstName RiTrip
SYMATTR Value 1
SYMBOL bi -1824 1600 R180
WINDOW 0 24 80 Left 2
WINDOW 3 41 -6 Left 2
SYMATTR InstName Bcomp
SYMATTR Value I=V(vg0)
SYMBOL cap -1664 1536 R0
SYMATTR InstName C5
SYMATTR Value {1/250k}
SYMATTR SpiceLine Rser=10m
SYMBOL bi -1824 2048 R180
WINDOW 0 24 80 Left 2
WINDOW 3 41 -6 Left 2
SYMATTR InstName Bcomp1
SYMATTR Value I=V(vg0)
SYMBOL cap -1664 1984 R0
SYMATTR InstName C6
SYMATTR Value {1/65k}
SYMBOL schottky -2064 1856 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -2064 1408 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D5
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL bv -2256 2016 M0
SYMATTR InstName B4
SYMATTR Value V=10*V(vg0)
SYMBOL bv -2368 1664 M0
SYMATTR InstName B5
SYMATTR Value V=if( V(ramptimer)>0.37, 10, 0)
SYMBOL res 528 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RoSns
SYMATTR Value 20m
SYMBOL bi 1856 1296 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -31 -159 Left 2
SYMATTR InstName Bslope
SYMATTR Value I=V(mcmp)
SYMBOL bi 704 1296 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -31 -159 Left 2
SYMATTR InstName Bprobe1
SYMATTR Value I=I(Rprobe)
SYMBOL res 928 1216 R0
SYMATTR InstName RiSense1
SYMATTR Value 1
SYMBOL cap 832 1248 R0
SYMATTR InstName C7
SYMATTR Value 10n
SYMBOL voltage 944 176 R180
WINDOW 0 24 96 Left 2
WINDOW 3 -413 -2 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(25.4 24 4m 1u 1u 4m 10m)
SYMBOL res 480 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 499
SYMBOL cap 656 832 R0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL bi -32 -576 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -31 -159 Left 2
SYMATTR InstName BinPOW
SYMATTR Value I=abs(I(Vsupply)*V(Vin))
SYMBOL res 352 -656 R0
SYMATTR InstName RiSense3
SYMATTR Value 1
SYMBOL cap 256 -624 R0
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL res 576 -768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense4
SYMATTR Value 10
SYMBOL cap 672 -624 R0
SYMATTR InstName C9
SYMATTR Value 500n
SYMBOL res 928 -768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense5
SYMATTR Value 100
SYMBOL cap 1024 -624 R0
SYMATTR InstName C10
SYMATTR Value 50n
SYMBOL res 1280 -768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense6
SYMATTR Value 1k
SYMBOL cap 1376 -624 R0
SYMATTR InstName C11
SYMATTR Value 10n
SYMBOL bi -64 -1088 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -31 -159 Left 2
SYMATTR InstName BinPOW1
SYMATTR Value I=abs(I(RoSns))
SYMBOL res 320 -1168 R0
SYMATTR InstName RiSense7
SYMATTR Value 1
SYMBOL cap 224 -1136 R0
SYMATTR InstName C12
SYMATTR Value 10µ
SYMBOL res 544 -1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense8
SYMATTR Value 10
SYMBOL cap 640 -1136 R0
SYMATTR InstName C13
SYMATTR Value 500n
SYMBOL res 896 -1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense9
SYMATTR Value 100
SYMBOL cap 992 -1136 R0
SYMATTR InstName C14
SYMATTR Value 50n
SYMBOL res 1248 -1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense10
SYMATTR Value 1k
SYMBOL cap 1344 -1136 R0
SYMATTR InstName C15
SYMATTR Value 10n
SYMBOL res -976 608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 350
SYMBOL cap -928 656 R0
SYMATTR InstName C16
SYMATTR Value 1n
SYMBOL Digital\\buf -784 560 R0
SYMATTR InstName A2
SYMBOL schottky -928 496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -992 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10
SYMBOL Digital\\and -544 928 R0
SYMATTR InstName A3
SYMBOL voltage -752 1024 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 1m 10n 10n 1)
SYMBOL res -1024 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 150
SYMBOL cap -976 1120 R0
SYMATTR InstName C17
SYMATTR Value 1n
SYMBOL schottky -976 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -1040 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10
SYMBOL schottky 400 304 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value DI
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1104 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RiSense11
SYMATTR Value 100
SYMBOL cap 1184 1248 R0
SYMATTR InstName C18
SYMATTR Value 1n
SYMBOL sw 208 672 M180
SYMATTR InstName S1
SYMATTR Value FETSW
TEXT -136 936 Left 2 ;.tran 0 10m 0 10n
TEXT 192 1024 Left 2 !.model DI D(Vfwd=1u Ron=1u)
TEXT 256 2352 Left 2 !.param Rpd 1k
TEXT -120 1024 Left 2 !.param Rsense 6m
TEXT -136 968 Left 2 !.tran 0 3.074m 3.06m 1n
TEXT 256 520 Left 2 !.model FETSW SW(Ron=20m Roff=1Meg Vt=2.5 Vh=0.5)
